# nnmbot
## Описание
Telegram Bot для фильтрации Телеграм канала [NNMCLUB](t.me/nnmclubtor)  <br> <br>
Скрипрт на Python прослушивает Телеграм канал [NNMCLUB](t.me/nnmclubtor) и пересылает сообщения содержащие информацию только о фильмах на ваш личный канал. Фильтр настаривается в конфигурационном файле. <br><br>
Bot получает описание фильма с сайта https://nnmclub.to и рейтинг фильма с сайта [Кинопоиска](https://www.kinopoisk.ru) и [Imdb](https://www.imdb.com).<br><br>
Ведет локальную базу данных о пересланных сообщениях - фильмах.<br><br>
Исключает из пересылки повторяющиеся фильмы.<br><br>
На данный момент используется два подключения к Telegram. Одно подключение как пользователь, второе как Bot. Два подключения используется потому, что Bot не может прослушивать каналы на которые он не подписан. 

Для прослушивания используется первое подключение как пользователя. С помощью этого соединения получаем сообщения согласно настроенному фильтру, из канала [NNMCLUB](t.me/nnmclubtor) и пересылаем его в наш личный канал. Там сообщение подхватывает уже Bot - второе соединение и присоединяет к нему кнопки управления - 'Add to DB' и 'Control DB'. 

Управлять базой данных (DB) могут только администраторы канала. По нажатию первой кнопки в базе отмечается фильм на котором нажата кнопка (tagged film). Можно убрать отметку, но в базе останется признак снятия отметки (early tagged). 

По второй кнопке происходит перенаправление  на диалог с Bot(ом) где появляется меню управления базой данных. Доступны следующие действия:<br>
* List Films tagged - Вывести список помеченных фильмов
* List Films tagged early - Вывести список  фильмов у которых снята ранее проставленнная отметка
* Clear all tagged Films - очистить все отметки
* Get database info - получить информацию о записях в базе данных
* Search Films in database - поиск фильма в базе данных

## Настройка и запуск

Для работы Bot(а) требуется:
1. Получить на сайте [Telegram](https://my.telegram.org) api_id и api_hash
2. Зарегистрировать в Telegram через FatherBot нового Bot(a) и получить bot_token, изменить у бота режим /setprivacy на DISABLED
3. Создать новый канал куда будут пересылаться сообщения. Если хотите в конфигурационном файле указывать этот канал по имени, то сделайте канал публичным (public). 
4. Внести настройки в конфигурационный файл *config.py*  
5. Запустить скрипт.

